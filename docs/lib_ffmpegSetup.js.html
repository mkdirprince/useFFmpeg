<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lib/ffmpegSetup.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: lib/ffmpegSetup.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";
var __awaiter = (this &amp;&amp; this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.load = void 0;
const ffmpeg_1 = require("@ffmpeg/ffmpeg");
const util_1 = require("@ffmpeg/util");
/**
 * Loads the FFmpeg library with optional multi-threading support.
 *
 * This function initializes a new instance of FFmpeg, sets up event listeners for logging,
 * and loads the necessary core and WASM files from a given URL. If multi-threading is enabled,
 * it will load an additional worker script. If multi-threading (`mt`) is set to true, a base URL must
 * be provided for the FFmpeg core and worker scripts.
 *
 * @param {string} [baseUrl="https://unpkg.com/@ffmpeg/core@0.12.10/dist/esm"] - The base URL to load the FFmpeg core and WASM files from.
 * @param {boolean} [mt=false] - A flag to indicate if multi-threading should be enabled. If true, a worker script will be loaded. If multi-threading is enabled, `baseUrl` must be provided.
 *
 * @returns {Promise&lt;FFmpeg>} - A Promise that resolves to the initialized FFmpeg instance.
 *
 * @throws {Error} - Throws an error if the FFmpeg core or WASM files fail to load or if an error occurs during FFmpeg operations.
 *
 * @example
 * const ffmpeg = await load()
 * // By default, the base URL is provided for single-threaded transcoding. To use multi-threading, a base URL MUST be provided and `mt` should be set to true.
 * // You can now use the `ffmpeg` instance for transcoding tasks.
 */
const load = (...args_1) => __awaiter(void 0, [...args_1], void 0, function* (baseUrl = "https://unpkg.com/@ffmpeg/core@0.12.10/dist/esm", mt = false) {
    // inittialize a new ffmpeg instance
    const ffmpeg = new ffmpeg_1.FFmpeg();
    const singleThred = {
        coreURL: yield (0, util_1.toBlobURL)(`${baseUrl}/ffmpeg-core.js`, "text/javascript"),
        wasmURL: yield (0, util_1.toBlobURL)(`${baseUrl}/ffmpeg-core.wasm`, "application/wasm"),
    };
    try {
        if (mt) {
            yield ffmpeg.load(Object.assign(Object.assign({}, singleThred), { workerURL: yield (0, util_1.toBlobURL)(`${baseUrl}/ffmpeg-core.worker.js`, "text/javascript") }));
        }
        else {
            yield ffmpeg.load(singleThred);
        }
    }
    catch (error) {
        throw new Error(`Error loading FFmpeg core and WASM files from ${baseUrl}`);
    }
    return ffmpeg;
});
exports.load = load;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#extractMimeType">extractMimeType</a></li><li><a href="global.html#load">load</a></li><li><a href="global.html#transcode">transcode</a></li><li><a href="global.html#useFFmpeg">useFFmpeg</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Tue Jan 14 2025 15:58:28 GMT+0000 (Greenwich Mean Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
